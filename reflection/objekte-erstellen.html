
<!doctype html>
<html lang="de" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="datentyp-ermitteln.html">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Objekte dynamisch erstellen - C# Cheat Sheet</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#objekte-zur-laufzeit-erstellen" class="md-skip">
          Zum Inhalt
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Kopfzeile">
    <a href="../index.html" title="C# Cheat Sheet" class="md-header__button md-logo" aria-label="C# Cheat Sheet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            C# Cheat Sheet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Objekte dynamisch erstellen
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Suche" placeholder="Suche" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Suche">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Teilen" aria-label="Teilen" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Zurücksetzen" aria-label="Zurücksetzen" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="C# Cheat Sheet" class="md-nav__button md-logo" aria-label="C# Cheat Sheet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    C# Cheat Sheet
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Übersicht
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../string.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    String
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../schleifen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Schleifen
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dateien.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dateien
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../db/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Datenbankanbindung
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Datenbankanbindung
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/datanbankanbindung.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/verbindung.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verbindung herstellen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/daten-lesen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Daten lesen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/daten-schreiben.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Daten schreiben
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/beispiel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beispiel
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reflection
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reflection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="klasse-mitarbeiter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beispielklasse Mitarbeiter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datentyp-ermitteln.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datentyp dynamisch ermitteln
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Objekte dynamisch erstellen
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="objekte-erstellen.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Objekte dynamisch erstellen
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#verwendung-des-activators" class="md-nav__link">
    <span class="md-ellipsis">
      Verwendung des Activators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verwendung des Activators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#erklarung" class="md-nav__link">
    <span class="md-ellipsis">
      Erklärung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vorteile-und-uberlegungen" class="md-nav__link">
    <span class="md-ellipsis">
      Vorteile und Überlegungen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamische-wertzuweisung-zu-properties-von-objekten" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamische Wertzuweisung zu Properties von Objekten
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamische Wertzuweisung zu Properties von Objekten">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamische-initialisierung-von-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamische Initialisierung von Properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erklarung_1" class="md-nav__link">
    <span class="md-ellipsis">
      Erklärung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wichtig-zu-beachten" class="md-nav__link">
    <span class="md-ellipsis">
      Wichtig zu beachten
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#verwendung-des-activators" class="md-nav__link">
    <span class="md-ellipsis">
      Verwendung des Activators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verwendung des Activators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#erklarung" class="md-nav__link">
    <span class="md-ellipsis">
      Erklärung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vorteile-und-uberlegungen" class="md-nav__link">
    <span class="md-ellipsis">
      Vorteile und Überlegungen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamische-wertzuweisung-zu-properties-von-objekten" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamische Wertzuweisung zu Properties von Objekten
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamische Wertzuweisung zu Properties von Objekten">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamische-initialisierung-von-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamische Initialisierung von Properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erklarung_1" class="md-nav__link">
    <span class="md-ellipsis">
      Erklärung
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wichtig-zu-beachten" class="md-nav__link">
    <span class="md-ellipsis">
      Wichtig zu beachten
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="objekte-zur-laufzeit-erstellen">Objekte zur Laufzeit erstellen<a class="headerlink" href="#objekte-zur-laufzeit-erstellen" title="Permanent link">#</a></h1>
<p>Ein zentraler Aspekt von Reflection in C# ist die Fähigkeit, Objekte zur Laufzeit zu erstellen. Diese Fähigkeit ist besonders nützlich in Szenarien, in denen Typen dynamisch zur Laufzeit geladen oder instanziiert werden müssen, ohne dass sie zur Kompilierungszeit bekannt sind. Ein häufig verwendetes Werkzeug dafür ist die Klasse <code>Activator</code>, die Teil des .NET Frameworks ist.</p>
<h2 id="verwendung-des-activators">Verwendung des Activators<a class="headerlink" href="#verwendung-des-activators" title="Permanent link">#</a></h2>
<p>Die <code>Activator</code>-Klasse bietet mehrere Methoden, um Instanzen von Typen zur Laufzeit zu erstellen. Eine der gebräuchlichsten Methoden ist <code>CreateInstance</code>. Diese Methode hat mehrere Überladungen, die es ermöglichen, Objekte auf verschiedene Arten zu instanziieren, unter anderem durch Angabe des Typs, der Parameter für den Konstruktor und sogar durch Angabe des Assemblynamens, in dem sich der Typ befindet.</p>
<p>Um ein Objekt vom Typ <code>Mitarbeiter</code> zur Laufzeit zu erstellen, können wir folgenden Ansatz verfolgen:</p>
<div class="language-csharp highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">// Erstellen eines Objekts vom Typ Mitarbeiter ohne Parameter (nutzt den Standardkonstruktor)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">Mitarbeiter</span><span class="w"> </span><span class="n">mitarbeiter1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Mitarbeiter</span><span class="p">)</span><span class="n">Activator</span><span class="p">.</span><span class="n">CreateInstance</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Mitarbeiter</span><span class="p">));</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1">// Initialisierung der Attribute für mitarbeiter1</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">mitarbeiter1</span><span class="p">.</span><span class="n">Vorname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Anna&quot;</span><span class="p">;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">mitarbeiter1</span><span class="p">.</span><span class="n">Nachname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Müller&quot;</span><span class="p">;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">mitarbeiter1</span><span class="p">.</span><span class="n">Gehalt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40000.0</span><span class="p">;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">mitarbeiter1</span><span class="p">.</span><span class="n">Arbeitsort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hamburg&quot;</span><span class="p">;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1">// Erstellen eines Objekts vom Typ Mitarbeiter mit Parametern für den Konstruktor</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="kt">object</span><span class="p">[]</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;Max&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mustermann&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">50000.0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Berlin&quot;</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">Mitarbeiter</span><span class="w"> </span><span class="n">mitarbeiter2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Mitarbeiter</span><span class="p">)</span><span class="n">Activator</span><span class="p">.</span><span class="n">CreateInstance</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Mitarbeiter</span><span class="p">),</span><span class="w"> </span><span class="n">parameters</span><span class="p">);</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c1">// Ausgabe zur Demonstration</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">mitarbeiter1</span><span class="p">.</span><span class="n">AnzeigenInformationen</span><span class="p">();</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">mitarbeiter2</span><span class="p">.</span><span class="n">AnzeigenInformationen</span><span class="p">();</span>
</span></code></pre></div>
<details class="quote">
<summary>Output</summary>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Vorname: Anna, Nachname: Müller, Gehalt: 40000, Arbeitsort: Hamburg
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>Vorname: Max, Nachname: Mustermann, Gehalt: 50000, Arbeitsort: Berlin
</span></code></pre></div>
</details>
<h3 id="erklarung">Erklärung<a class="headerlink" href="#erklarung" title="Permanent link">#</a></h3>
<ul>
<li>
<p><strong><code>Activator.CreateInstance(typeof(Mitarbeiter))</code></strong>: Diese Zeile erstellt eine neue Instanz von <code>Mitarbeiter</code> unter Verwendung des Standardkonstruktors. Da <code>CreateInstance</code> ein Objekt vom Typ <code>object</code> zurückgibt, ist ein explizites Casting auf den Typ <code>Mitarbeiter</code> notwendig.</p>
</li>
<li>
<p><strong><code>Activator.CreateInstance(typeof(Mitarbeiter), parameters)</code></strong>: Hier wird eine neue Instanz von <code>Mitarbeiter</code> erstellt, wobei ein Array von Objekten als Parameter für den Konstruktor übergeben wird. Diese Methode ist nützlich, wenn der zu verwendende Konstruktor Parameter erwartet. Auch hier ist ein Casting erforderlich.</p>
</li>
</ul>
<h3 id="vorteile-und-uberlegungen">Vorteile und Überlegungen<a class="headerlink" href="#vorteile-und-uberlegungen" title="Permanent link">#</a></h3>
<p>Die Verwendung des <code>Activator</code> zum Erstellen von Objekten bietet eine flexible Lösung für die dynamische Instanziierung von Klassen zur Laufzeit. Dies kann in Situationen nützlich sein, in denen der exakte Typ eines Objekts erst zur Laufzeit bekannt ist, beispielsweise beim Laden von Plugins oder bei der Implementierung von Fabrikmethoden in Designmustern.</p>
<p>Es ist jedoch wichtig zu beachten, dass der Einsatz von Reflection und insbesondere des <code>Activator</code> zur Objekterstellung Overhead verursacht und die Performance beeinträchtigen kann. Deshalb sollte der Einsatz wohlüberlegt und in Performance-kritischen Bereichen vermieden oder minimiert werden.</p>
<h2 id="dynamische-wertzuweisung-zu-properties-von-objekten">Dynamische Wertzuweisung zu Properties von Objekten<a class="headerlink" href="#dynamische-wertzuweisung-zu-properties-von-objekten" title="Permanent link">#</a></h2>
<p>In Szenarien, wo die Properties eines Objekts zur Laufzeit nicht bekannt sind, bietet Reflection in C# die Möglichkeit, dynamisch auf diese Properties zuzugreifen und ihnen Werte zuzuweisen. Dies kann besonders nützlich sein, wenn man mit Objekten arbeitet, deren Struktur erst zur Laufzeit bestimmt wird, wie es beispielsweise bei der dynamischen Erzeugung von Objekten aus Datenbankabfragen oder bei der Deserialisierung von JSON-Objekten der Fall ist.</p>
<p>Um dieses Konzept zu demonstrieren, verwenden wir wieder die <code>Mitarbeiter</code>-Klasse. Wir zeigen, wie man die Properties eines <code>Mitarbeiter</code>-Objekts dynamisch abfragen und mit Standardwerten initialisieren kann.</p>
<h3 id="dynamische-initialisierung-von-properties">Dynamische Initialisierung von Properties<a class="headerlink" href="#dynamische-initialisierung-von-properties" title="Permanent link">#</a></h3>
<p>Der Schlüssel zur dynamischen Arbeit mit Properties ist die Verwendung der <code>GetProperty</code>- und <code>SetValue</code>-Methoden des <code>Type</code>-Objekts, die über Reflection zugänglich sind. Hier ist ein grundlegendes Beispiel, das die Properties mit Standardwerten belegt:</p>
<div class="language-csharp highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">// Erstellen eines Objekts vom Typ Mitarbeiter zur Laufzeit</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">Mitarbeiter</span><span class="w"> </span><span class="n">mitarbeiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Mitarbeiter</span><span class="p">)</span><span class="n">Activator</span><span class="p">.</span><span class="n">CreateInstance</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Mitarbeiter</span><span class="p">));</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1">// Dynamische Initialisierung von Properties</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">PropertyInfo</span><span class="p">[]</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">typeof</span><span class="p">(</span><span class="n">Mitarbeiter</span><span class="p">).</span><span class="n">GetProperties</span><span class="p">();</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">properties</span><span class="p">)</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="p">{</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">property</span><span class="p">.</span><span class="n">PropertyType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">typeof</span><span class="p">(</span><span class="kt">string</span><span class="p">))</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">        </span><span class="n">property</span><span class="p">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">mitarbeiter</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Standardwert&quot;</span><span class="p">);</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">property</span><span class="p">.</span><span class="n">PropertyType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">typeof</span><span class="p">(</span><span class="kt">double</span><span class="p">))</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">        </span><span class="n">property</span><span class="p">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">mitarbeiter</span><span class="p">,</span><span class="w"> </span><span class="m">0.0</span><span class="p">);</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w">    </span><span class="c1">// Fügen Sie hier weitere Typüberprüfungen und -zuweisungen hinzu, je nach Bedarf</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="p">}</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="c1">// Ausgabe zur Demonstration der dynamischen Initialisierung</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="n">mitarbeiter</span><span class="p">.</span><span class="n">AnzeigenInformationen</span><span class="p">();</span>
</span></code></pre></div>
<details class="quote">
<summary>Output</summary>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Vorname: Standardwert, Nachname: Standardwert, Gehalt: 0, Arbeitsort: Standardwert
</span></code></pre></div>
</details>
<h3 id="erklarung_1">Erklärung<a class="headerlink" href="#erklarung_1" title="Permanent link">#</a></h3>
<ul>
<li>Zunächst wird ein <code>Mitarbeiter</code>-Objekt zur Laufzeit erstellt.</li>
<li>Anschließend wird das <code>Type</code>-Objekt des <code>Mitarbeiter</code>-Typs verwendet, um alle öffentlichen Properties zu erhalten.</li>
<li>Für jede Property wird überprüft, welchen Typ sie hat (<code>string</code>, <code>double</code> usw.), und es wird ein entsprechender Standardwert zugewiesen. Im Beispiel wird allen <code>string</code>-Properties der Wert <code>"Standardwert"</code> und allen <code>double</code>-Properties der Wert <code>0.0</code> zugewiesen.</li>
<li>Schließlich wird eine Methode des Objekts aufgerufen, um die Ergebnisse der dynamischen Property-Zuweisungen zu überprüfen.</li>
</ul>
<h3 id="wichtig-zu-beachten">Wichtig zu beachten<a class="headerlink" href="#wichtig-zu-beachten" title="Permanent link">#</a></h3>
<ul>
<li>Diese Methode der dynamischen Wertzuweisung ist sehr flexibel, kann aber auch fehleranfällig sein, wenn die Typen der Properties nicht korrekt gehandhabt werden.</li>
<li>Reflection kann die Performance beeinträchtigen, daher sollte sie mit Bedacht eingesetzt werden, insbesondere in leistungskritischen Anwendungen.</li>
<li>Die Sicherheit des Zugriffs auf Properties sollte ebenfalls berücksichtigt werden, da die Verwendung von Reflection potenziell unsichere oder unerwünschte Zugriffe auf Objekte ermöglichen kann.</li>
</ul>
<p>Diese Technik ermöglicht es Entwicklern, sehr dynamisch mit Objekten zu arbeiten, deren Struktur im Voraus nicht vollständig bekannt ist, und bietet eine mächtige Methode zur Laufzeitmanipulation und -initialisierung von Objekten in C#.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.annotate", "search.suggest", "search.share", "navigation.indexes"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>